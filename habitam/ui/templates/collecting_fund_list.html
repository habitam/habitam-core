{% extends 'building.html' %} 
{% load ui_extras %}

{% block building_body %}
<table class="table table-hover table-condensed">
	<thead>
		<tr>
			<th>Nume</th>
			<th class="hidden-phone">Tip</th>
			<th class="hidden-phone">Tip bani</th>			
			<th class="hidden-phone">Colectare de la</th>
			<th>De colectat</th>
			<th>Balanță</th>
			<th class="hidden-phone">&nbsp;</th>
		</tr>
	</thead>
	<tbody>
		{% for service in building.collecting_funds %}
		{% valid_timestamp service.archive_date user.administrator.license as valid %}
		{% if valid %}
		{% if show_all or not service.archived %}
			<tr>
				<td {% if service.archived %}class="archived"{% endif %}><a href="javascript:editDialog('{% url 'edit_billable_collecting' entity_id=service.id %}')">{{ service }}</a></td>
				<td class="{% if service.archived %}archived{% endif %} hidden-phone">{{ service.account.type }}</td>				
				<td class="{% if service.archived %}archived{% endif %} hidden-phone">{{ service.account.money_type }}</td>
				<td class="{% if service.archived %}archived{% endif %} hidden-phone">{{ service.billed }}</td>
				<td class="{% if service.archived %}archived {% endif %}{% if service.to_collect > 0 %}negative_balance{% else %}positive_balance{% endif %}"><a href="{% url 'operation_list' building_id=building.id account_id=service.account.id %}">{{ service.to_collect|floatformat:2 }}</a></td>
				<td class="{% if service.archived %}archived {% endif %}{% if service.balance < 0 %}negative_balance{% else %}positive_balance{% endif %}"><a href="{% url 'operation_list' building_id=building.id account_id=service.account.id %}">{{ service.balance|floatformat:2 }}</a></td>
				<td class="hidden-phone">
					{% if not service.archived %}
					<div class="btn-group">
						<button class="btn btn-mini" type="button" onclick="editDialog('{% url 'new_fund_transfer' account_id=service.account.id %}')" title="Transferă bani într-un alt cont sau fond"><i class="icon-retweet"></i></button>
						<button class="btn btn-mini btn-info" type="button" onclick="editDialog('{% url 'new_collection' entity_id=service.id %}')" title="Definește un nou obiectiv de colectare"><i class="icon-plus-sign icon-white"></i> Colectare</button>
						<button class="btn btn-mini btn-inverse" type="button" onclick="editDialog('{% url 'new_service_payment' account_id=service.account.id %}')" title="Plătește un serviciu"><i class="icon-share-alt icon-white"></i> Serviciu</button>
						<button class="btn btn-mini btn-inverse" type="button" onclick="editDialog('{% url 'new_other_service_payment' account_id=service.account.id %}')" title="Plătește serviciile unui terț neînregistrat în sistem"><i class="icon-share-alt icon-white"></i> Terț</button>
					</div>
					{% endif %}
					<div class="btn-group">
					    {% if service.can_delete %}<button class="btn btn-mini btn-danger" data-target="#deleteModal" data-toggle="modal" role="buton" onclick="delete_click('{% url 'edit_billable_collecting' entity_id=service.id %}');"><i class="icon-trash icon-white"></i></button>{% endif %}
					</div>
				</td>
			</tr>
		{% endif %}
		{% endif %}
		{% endfor %}
	</tbody>
</table>
<div class="container hidden-phone">
	<div class="pull-right">
		<a href="{% if show_all %}{% url 'collecting_fund_list' building.id %}{% else %}{% url 'all_collecting_fund_list' building.id %}{% endif %}" class="btn{% if show_all %} active{% endif %}">Toate fondurile</a>
		<button class="btn btn-info" type="button" onclick="editDialog('{% url 'new_billable_collecting' building.id %}')">Fond nou</button>
	</div>
</div>	
{% endblock %}