{% extends 'building.html' %} 
{% load ui_extras %}

{% block building_body %}
<table class="table table-hover table-condensed">
	<thead>
		<tr>
			<th>Nume</th>
			<th>Tip</th>
			<th>Tip bani</th>			
			<th>Colectare de la</th>
			<th>De colectat</th>
			<th>Balanță</th>
			<th>&nbsp;</th>
		</tr>
	</thead>
	<tbody>
		{% for service in building.collecting_funds %}
		{% valid_timestamp service.archive_date user.administrator.license as valid %}
		{% if valid %}
		{% if show_all or not service.archived %}
			<tr>
				<td {% if service.archived %}class="archived"{% endif %}><a href="javascript:editDialog('{% url 'edit_billable_collecting' entity_id=service.id %}')">{{ service }}</a></td>
				<td {% if service.archived %}class="archived"{% endif %}>{{ service.account.type }}</td>				
				<td {% if service.archived %}class="archived"{% endif %}>{{ service.account.money_type }}</td>
				<td {% if service.archived %}class="archived"{% endif %}>{{ service.billed }}</td>
				<td class="{% if service.archived %}archived {% endif %}{% if service.to_collect > 0 %}negative_balance{% else %}positive_balance{% endif %}"><a href="{% url 'operation_list' building_id=building.id account_id=service.account.id %}">{{ service.to_collect|floatformat:2 }}</a></td>
				<td class="{% if service.archived %}archived {% endif %}{% if service.balance < 0 %}negative_balance{% else %}positive_balance{% endif %}"><a href="{% url 'operation_list' building_id=building.id account_id=service.account.id %}">{{ service.balance|floatformat:2 }}</a></td>
				<td>
					{% if not service.archived %}
					<div class="btn-group">
						<button class="btn btn-mini btn-inverse" type="button" onclick="editDialog('{% url 'new_collection' entity_id=service.id %}')"><i class="icon-plus-sign icon-white"></i> Colectare nouă</button>
						<button class="btn btn-mini btn-inverse" type="button" onclick="editDialog('{% url 'new_service_payment' account_id=service.account.id %}')"><i class="icon-share-alt icon-white"></i> Plată serviciu</button>
						<button class="btn btn-mini btn-inverse" type="button" onclick="editDialog('{% url 'new_other_service_payment' account_id=service.account.id %}')"><i class="icon-share-alt icon-white"></i> Plată terț</button>
					</div>
					{% endif %}
					<div class="btn-group">
					    {% if service.can_delete %}<button class="btn btn-mini btn-danger" data-target="#deleteModal" data-toggle="modal" role="buton" onclick="delete_click('{% url 'edit_billable_collecting' entity_id=service.id %}');"><i class="icon-trash icon-white"></i></button>{% endif %}
					</div>
				</td>
			</tr>
		{% endif %}
		{% endif %}
		{% endfor %}
	</tbody>
</table>
<div class="container">
	<div class="pull-right">
		<a href="{% if show_all %}{% url 'collecting_fund_list' building.id %}{% else %}{% url 'all_collecting_fund_list' building.id %}{% endif %}" class="btn{% if show_all %} active{% endif %}">Toate fondurile</a>
		<button class="btn btn-info" type="button" onclick="editDialog('{% url 'new_billable_collecting' building.id %}')">Fond nou</button>
	</div>
</div>	
{% endblock %}